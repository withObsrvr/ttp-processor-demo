# Multi-Network Ingestion - Test Configuration
# Small ledger ranges for initial testing and validation

service:
  name: "ducklake-multi-network-ingester-test"
  environment: "test"

# MULTI-SOURCE CONFIGURATION (Test Mode)
sources:
  # Testnet - Small test range
  - name: "testnet"
    enabled: true
    endpoint: "localhost:50051"  # Assumes stellar-live-source running locally
    network_passphrase: "Test SDF Network ; September 2015"
    start_ledger: 1000
    end_ledger: 1050  # Only 50 ledgers for quick test
    live_mode: false
    poll_interval_seconds: 5

    pipeline:
      batch_size: 10
      pool:
        workers: 1  # Single worker for simplicity
        queue_size: 100

  # Mainnet - Small test range (not production!)
  - name: "mainnet"
    enabled: true  # Re-enabled with new API key
    endpoint: "localhost:50052"  # Separate mainnet endpoint
    network_passphrase: "Public Global Stellar Network ; September 2015"
    start_ledger: 1000      # Match testnet for testing
    end_ledger: 1050        # Only 50 ledgers for quick test
    live_mode: false
    poll_interval_seconds: 5

    pipeline:
      batch_size: 10
      pool:
        workers: 1  # Single worker for simplicity
        queue_size: 100

  # Futurenet - Disabled for initial test
  - name: "futurenet"
    enabled: false
    endpoint: "localhost:50051"
    network_passphrase: "Test SDF Future Network ; October 2022"
    start_ledger: 1000
    end_ledger: 1050
    live_mode: false
    poll_interval_seconds: 5

    pipeline:
      batch_size: 10
      pool:
        workers: 1
        queue_size: 100

# SHARED DUCKLAKE CONFIGURATION
ducklake:
  # Test catalog (will be created fresh)
  catalog_path: "./catalogs/multi-network-test.duckdb"

  # Data path template (empty for local file catalog)
  data_path: ""

  # Catalog name
  catalog_name: "multi_network_test"

  # Partition settings
  partition_size: 64000

  # S3/B2 settings (not used for local test)
  aws_access_key_id: ""
  aws_secret_access_key: ""
  aws_region: "us-west-004"
  aws_endpoint: ""

  # Batch/commit settings
  batch_size: 50
  commit_interval_seconds: 10  # Shorter for testing

  # Performance settings
  data_inlining_row_limit: 0
  use_upsert: false
  create_indexes: false

# SHARED WRITE QUEUE CONFIGURATION
write_queue:
  size: 100              # Smaller queue for testing
  timeout_seconds: 60

  # Monitoring
  log_queue_depth: true
  log_interval_seconds: 10  # More frequent logging for testing

# Checkpoint configuration
checkpoint:
  enabled: true
  dir: "./state-test"

# Manifest & PAS
manifest:
  enabled: false  # Disable for initial test

pas:
  enabled: false  # Disable for initial test

# Metrics (Prometheus)
metrics:
  enabled: false  # Disable for initial test

# Logging
logging:
  level: "info"
  format: "console"

# Advanced Settings
advanced:
  max_concurrent_sources: 3
  shutdown_timeout_seconds: 30  # Shorter for testing
  health_check_interval_seconds: 30
